import{f as ee,w as re,x as Pe,e as fe,d as ke,t as Te,_ as Be,y as Fe,v as Se}from"./index-DaZGLv_X.js";import{N as c,Y as oe,k as $e,r as B,e as Ve,c as S,w as ce,o as Ne,a1 as K,a5 as O,R as v,a4 as d,a3 as k,aa as Ce,ab as Me,Q as X,a2 as q,F as Z,a0 as x,s as L,a9 as De,q as se,j as M,$ as D,ad as Ee,I as ae,E as Re,n as Ae}from"./vue-iyKSyPgD.js";import{s as Ie}from"./lodash-es-D7KfrSKz.js";import{Q as Ue,m as ze,e as qe}from"./vicons-antd-lylIHZTS.js";import{L as Le,M as Ge,e as Qe,f as Ye,r as We,g as Je,V as He,W as Ke,s as Xe,h as Ze,B as xe,d as et}from"./naive-ui-DTkP1Nhe.js";/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function ie(e){return Object.prototype.toString.call(e)==="[object Object]"}function tt(e){var r,t;return ie(e)===!1?!1:(r=e.constructor,r===void 0?!0:(t=r.prototype,!(ie(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Q.apply(this,arguments)}function de(e,r){if(e==null)return{};var t,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)r.indexOf(t=s[n])>=0||(o[t]=e[t]);return o}const nt={silent:!1,logLevel:"warn"},rt=["validator"],pe=Object.prototype,ye=pe.toString,ot=pe.hasOwnProperty,me=/^\s*function (\w+)/;function le(e){var r;const t=(r=e?.type)!==null&&r!==void 0?r:e;if(t){const n=t.toString().match(me);return n?n[1]:""}return""}const $=tt,st=e=>e;let g=st;const E=(e,r)=>ot.call(e,r),at=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e},R=Array.isArray||function(e){return ye.call(e)==="[object Array]"},A=e=>ye.call(e)==="[object Function]",J=e=>$(e)&&E(e,"_vueTypes_name"),ve=e=>$(e)&&(E(e,"type")||["_vueTypes_name","validator","default","required"].some(r=>E(e,r)));function te(e,r){return Object.defineProperty(e.bind(r),"__original",{value:e})}function V(e,r,t=!1){let n,o=!0,s="";n=$(e)?e:{type:e};const a=J(n)?n._vueTypes_name+" - ":"";if(ve(n)&&n.type!==null){if(n.type===void 0||n.type===!0||!n.required&&r===void 0)return o;R(n.type)?(o=n.type.some(i=>V(i,r,!0)===!0),s=n.type.map(i=>le(i)).join(" or ")):(s=le(n),o=s==="Array"?R(r):s==="Object"?$(r):s==="String"||s==="Number"||s==="Boolean"||s==="Function"?function(i){if(i==null)return"";const l=i.constructor.toString().match(me);return l?l[1]:""}(r)===s:r instanceof n.type)}if(!o){const i=`${a}value "${r}" should be of type "${s}"`;return t===!1?(g(i),!1):i}if(E(n,"validator")&&A(n.validator)){const i=g,l=[];if(g=f=>{l.push(f)},o=n.validator(r),g=i,!o){const f=(l.length>1?"* ":"")+l.join(`
* `);return l.length=0,t===!1?(g(f),o):f}}return o}function j(e,r){const t=Object.defineProperties(r,{_vueTypes_name:{value:e,writable:!0},isRequired:{get(){return this.required=!0,this}},def:{value(o){return o===void 0?(E(this,"default")&&delete this.default,this):A(o)||V(this,o,!0)===!0?(this.default=R(o)?()=>[...o]:$(o)?()=>Object.assign({},o):o,this):(g(`${this._vueTypes_name} - invalid default value: "${o}"`),this)}}}),{validator:n}=t;return A(n)&&(t.validator=te(n,t)),t}function T(e,r){const t=j(e,r);return Object.defineProperty(t,"validate",{value(n){return A(this.validator)&&g(`${this._vueTypes_name} - calling .validate() will overwrite the current custom validator function. Validator info:
${JSON.stringify(this)}`),this.validator=te(n,this),this}})}function ue(e,r,t){const n=function(l){const f={};return Object.getOwnPropertyNames(l).forEach(y=>{f[y]=Object.getOwnPropertyDescriptor(l,y)}),Object.defineProperties({},f)}(r);if(n._vueTypes_name=e,!$(t))return n;const{validator:o}=t,s=de(t,rt);if(A(o)){let{validator:l}=n;l&&(l=(i=(a=l).__original)!==null&&i!==void 0?i:a),n.validator=te(l?function(f){return l.call(this,f)&&o.call(this,f)}:o,n)}var a,i;return Object.assign(n,s)}function H(e){return e.replace(/^(?!\s*$)/gm,"  ")}const it=()=>T("any",{}),lt=()=>T("function",{type:Function}),ut=()=>T("boolean",{type:Boolean}),ft=()=>T("string",{type:String}),ct=()=>T("number",{type:Number}),dt=()=>T("array",{type:Array}),pt=()=>T("object",{type:Object}),yt=()=>j("integer",{type:Number,validator:e=>at(e)}),mt=()=>j("symbol",{validator:e=>typeof e=="symbol"});function vt(e,r="custom validation failed"){if(typeof e!="function")throw new TypeError("[VueTypes error]: You must provide a function as argument");return j(e.name||"<<anonymous function>>",{type:null,validator(t){const n=e(t);return n||g(`${this._vueTypes_name} - ${r}`),n}})}function gt(e){if(!R(e))throw new TypeError("[VueTypes error]: You must provide an array as argument.");const r=`oneOf - value should be one of "${e.join('", "')}".`,t=e.reduce((n,o)=>{if(o!=null){const s=o.constructor;n.indexOf(s)===-1&&n.push(s)}return n},[]);return j("oneOf",{type:t.length>0?t:void 0,validator(n){const o=e.indexOf(n)!==-1;return o||g(r),o}})}function bt(e){if(!R(e))throw new TypeError("[VueTypes error]: You must provide an array as argument");let r=!1,t=[];for(let o=0;o<e.length;o+=1){const s=e[o];if(ve(s)){if(J(s)&&s._vueTypes_name==="oneOf"&&s.type){t=t.concat(s.type);continue}if(A(s.validator)&&(r=!0),s.type===!0||!s.type){g('oneOfType - invalid usage of "true" or "null" as types.');continue}t=t.concat(s.type)}else t.push(s)}t=t.filter((o,s)=>t.indexOf(o)===s);const n=t.length>0?t:null;return j("oneOfType",r?{type:n,validator(o){const s=[],a=e.some(i=>{const l=V(J(i)&&i._vueTypes_name==="oneOf"?i.type||null:i,o,!0);return typeof l=="string"&&s.push(l),l===!0});return a||g(`oneOfType - provided value does not match any of the ${s.length} passed-in validators:
${H(s.join(`
`))}`),a}}:{type:n})}function _t(e){return j("arrayOf",{type:Array,validator(r){let t="";const n=r.every(o=>(t=V(e,o,!0),t===!0));return n||g(`arrayOf - value validation error:
${H(t)}`),n}})}function ht(e){return j("instanceOf",{type:e})}function Ot(e){return j("objectOf",{type:Object,validator(r){let t="";const n=Object.keys(r).every(o=>(t=V(e,r[o],!0),t===!0));return n||g(`objectOf - value validation error:
${H(t)}`),n}})}function jt(e){const r=Object.keys(e),t=r.filter(o=>{var s;return!((s=e[o])===null||s===void 0||!s.required)}),n=j("shape",{type:Object,validator(o){if(!$(o))return!1;const s=Object.keys(o);if(t.length>0&&t.some(a=>s.indexOf(a)===-1)){const a=t.filter(i=>s.indexOf(i)===-1);return g(a.length===1?`shape - required property "${a[0]}" is not defined.`:`shape - required properties "${a.join('", "')}" are not defined.`),!1}return s.every(a=>{if(r.indexOf(a)===-1)return this._vueTypes_isLoose===!0||(g(`shape - shape definition does not include a "${a}" property. Allowed keys: "${r.join('", "')}".`),!1);const i=V(e[a],o[a],!0);return typeof i=="string"&&g(`shape - "${a}" property validation error:
 ${H(i)}`),i===!0})}});return Object.defineProperty(n,"_vueTypes_isLoose",{writable:!0,value:!1}),Object.defineProperty(n,"loose",{get(){return this._vueTypes_isLoose=!0,this}}),n}const wt=["name","validate","getter"],Pt=(()=>{var e;return(e=class{static get any(){return it()}static get func(){return lt().def(this.defaults.func)}static get bool(){return ut().def(this.defaults.bool)}static get string(){return ft().def(this.defaults.string)}static get number(){return ct().def(this.defaults.number)}static get array(){return dt().def(this.defaults.array)}static get object(){return pt().def(this.defaults.object)}static get integer(){return yt().def(this.defaults.integer)}static get symbol(){return mt()}static get nullable(){return{type:null}}static extend(r){if(R(r))return r.forEach(l=>this.extend(l)),this;const{name:t,validate:n=!1,getter:o=!1}=r,s=de(r,wt);if(E(this,t))throw new TypeError(`[VueTypes error]: Type "${t}" already defined`);const{type:a}=s;if(J(a))return delete s.type,Object.defineProperty(this,t,o?{get:()=>ue(t,a,s)}:{value(...l){const f=ue(t,a,s);return f.validator&&(f.validator=f.validator.bind(f,...l)),f}});let i;return i=o?{get(){const l=Object.assign({},s);return n?T(t,l):j(t,l)},enumerable:!0}:{value(...l){const f=Object.assign({},s);let y;return y=n?T(t,f):j(t,f),f.validator&&(y.validator=f.validator.bind(y,...l)),y},enumerable:!0},Object.defineProperty(this,t,i)}}).defaults={},e.sensibleDefaults=void 0,e.config=nt,e.custom=vt,e.oneOf=gt,e.instanceOf=ht,e.oneOfType=bt,e.arrayOf=_t,e.objectOf=Ot,e.shape=jt,e.utils={validate:(r,t)=>V(t,r,!0)===!0,toType:(r,t,n=!1)=>n?T(r,t):j(r,t)},e})();function ge(e={func:()=>{},bool:!0,string:"",number:0,array:()=>[],object:()=>({}),integer:0}){var r;return(r=class extends Pt{static get sensibleDefaults(){return Q({},this.defaults)}static set sensibleDefaults(t){this.defaults=t!==!1?Q({},t!==!0?t:e):{}}}).defaults=Q({},e),r}class Et extends ge(){}const G=ge({func:void 0,bool:void 0,string:void 0,number:void 0,object:void 0,integer:void 0});G.extend([{name:"style",getter:!0,type:[String,Object],default:void 0},{name:"VNodeChild",getter:!0,type:void 0}]);function kt(e){return e==="NInput"?"请输入":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"请选择":""}function Tt({emit:e,getProps:r,formModel:t,getSchema:n,formElRef:o,defaultFormModel:s,loadingSub:a,handleFormValues:i}){async function l(){return c(o)?.validate()}async function f(p){p&&p.preventDefault(),a.value=!0;const{submitFunc:h}=c(r);if(h&&ee(h))return await h(),a.value=!1,!1;if(!c(o))return!1;try{await l();const b=N();return a.value=!1,e("submit",b),b}catch(b){return e("submit",!1),a.value=!1,console.error(b),!1}}async function y(){await c(o)?.restoreValidation()}async function I(){const{resetFunc:p,submitOnReset:h}=c(r);if(p&&ee(p)&&await p(),!c(o))return;Object.keys(t).forEach(C=>{t[C]=c(s)[C]||null}),await y();const b=i(oe(c(t)));e("reset",b),h&&await f()}function N(){return c(o)?i(oe(c(t))):{}}async function U(p){const h=c(n).map(w=>w.field).filter(Boolean);Object.keys(p).forEach(w=>{const b=p[w];h.includes(w)&&(t[w]=b)})}function P(p){a.value=p}return{handleSubmit:f,validate:l,resetFields:I,getFieldsValue:N,clearValidate:y,setFieldsValue:U,setLoading:P}}function Bt({defaultFormModel:e,getSchema:r,formModel:t}){function n(s){if(!Pe(s))return{};const a={};for(const i of Object.entries(s)){let[,l]=i;const[f]=i;!f||fe(l)&&l.length===0||ee(l)||re(l)||(ke(l)&&(l=l.trim()),Ie(a,f,l))}return a}function o(){const s=c(r),a={};s.forEach(i=>{const{defaultValue:l}=i;re(l)||(a[i.field]=l,t[i.field]=l)}),e.value=a}return{handleFormValues:n,initDefault:o}}const Ft={labelWidth:{type:[Number,String],default:80},schemas:{type:[Array],default:()=>[]},layout:{type:String,default:"block"},inline:{type:Boolean,default:!1},size:{type:String,default:"medium"},labelPlacement:{type:String,default:"left"},isFull:{type:Boolean,default:!0},showActionButtonGroup:G.bool.def(!0),showResetButton:G.bool.def(!0),resetButtonOptions:Object,showSubmitButton:G.bool.def(!0),submitButtonOptions:Object,showAdvancedButton:G.bool.def(!1),submitButtonText:{type:String,default:"查詢"},resetButtonText:{type:String,default:"清除"},gridProps:Object,giProps:Object,baseGridStyle:{type:Object},collapsed:{type:Boolean,default:!1},collapsedRows:{type:Number,default:1}},St=$e({name:"BasicForm",components:{DownOutlined:qe,UpOutlined:ze,QuestionCircleOutlined:Ue},props:{...Ft},emits:["reset","submit","register"],setup(e,{emit:r,attrs:t}){const n=B({}),o=Ve({}),s=B({}),a=B(null),i=B(null),l=B(!0),f=B(!1),y=B(!1),I=S(()=>Object.assign({size:e.size,type:"primary"},e.submitButtonOptions)),N=S(()=>Object.assign({size:e.size,type:"default"},e.resetButtonOptions));function U(m){const F=m.componentProps??{},z=m.component;return{clearable:!0,placeholder:kt(c(z)),...F}}const P=S(()=>{const m={...e,...c(s)},F={rules:{}};return(m.schemas||[]).forEach(W=>{W.rules&&fe(W.rules)&&(F.rules[W.field]=W.rules)}),{...m,...c(F)}}),p=S(()=>{const{layout:m}=c(P);return m==="inline"}),h=S(()=>{const{gridProps:m}=c(P);return{...m,collapsed:p.value?l.value:!1,responsive:"screen"}}),w=S(()=>({...t,...e,...c(P)})),b=S(()=>{const m=c(a)||c(P).schemas;for(const F of m){const{defaultValue:z}=F;z&&(F.defaultValue=z)}return m}),{handleFormValues:C,initDefault:Y}=Bt({defaultFormModel:n,getSchema:b,formModel:o}),{handleSubmit:u,validate:_,resetFields:ne,getFieldsValue:be,clearValidate:_e,setFieldsValue:he}=Tt({emit:r,getProps:P,formModel:o,getSchema:b,formElRef:i,defaultFormModel:n,loadingSub:f,handleFormValues:C});function Oe(){l.value=!l.value}async function je(m){s.value=Te(c(s)||{},m)}const we={getFieldsValue:be,setFieldsValue:he,resetFields:ne,validate:_,clearValidate:_e,setProps:je,submit:u};return ce(()=>b.value,m=>{c(y)||m?.length&&(Y(),y.value=!0)}),Ne(()=>{Y(),r("register",we)}),{formElRef:i,formModel:o,getGrid:h,getProps:P,getBindValue:w,getSchema:b,getSubmitBtnOptions:I,getResetBtnOptions:N,handleSubmit:u,resetFields:ne,loadingSub:f,isInline:p,getComponentProps:U,unfoldToggle:Oe}}});function $t(e,r,t,n,o,s){const a=K("QuestionCircleOutlined"),i=Ze,l=Xe,f=Je,y=We,I=Ye,N=Ke,U=He,P=Qe,p=Ge,h=xe,w=K("DownOutlined"),b=K("UpOutlined"),C=Le,Y=et;return v(),O(Y,L(e.getBindValue,{model:e.formModel,ref:"formElRef"}),{default:d(()=>[k(C,Ce(Me(e.getGrid)),{default:d(()=>[(v(!0),X(Z,null,x(e.getSchema,u=>(v(),O(p,L({ref_for:!0},u.giProps,{key:u.field}),{default:d(()=>[k(P,{label:u.label,path:u.field},De({default:d(()=>[u.slot?se(e.$slots,u.slot,{key:0,model:e.formModel,field:u.field,value:e.formModel[u.field]},void 0,!0):u.component==="NCheckbox"?(v(),O(I,{key:1,value:e.formModel[u.field],"onUpdate:value":_=>e.formModel[u.field]=_},{default:d(()=>[k(y,null,{default:d(()=>[(v(!0),X(Z,null,x(u.componentProps.options,_=>(v(),O(f,{key:_.value,value:_.value,label:_.label},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):u.component==="NRadioGroup"?(v(),O(U,{key:2,value:e.formModel[u.field],"onUpdate:value":_=>e.formModel[u.field]=_},{default:d(()=>[k(y,null,{default:d(()=>[(v(!0),X(Z,null,x(u.componentProps.options,_=>(v(),O(N,{key:_.value,value:_.value},{default:d(()=>[M(D(_.label),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):(v(),O(Ee(u.component),L({key:3,ref_for:!0},e.getComponentProps(u),{value:e.formModel[u.field],"onUpdate:value":_=>e.formModel[u.field]=_,class:{isFull:u.isFull!=!1&&e.getProps.isFull}}),null,16,["value","onUpdate:value","class"])),u.suffix?se(e.$slots,u.suffix,{key:4,model:e.formModel,field:u.field,value:e.formModel[u.field]},void 0,!0):q("",!0)]),_:2},[u.labelMessage?{name:"label",fn:d(()=>[M(D(u.label)+" ",1),k(l,{trigger:"hover",style:ae(u.labelMessageStyle)},{trigger:d(()=>[k(i,{size:"18",class:"text-gray-400 cursor-pointer"},{default:d(()=>[k(a)]),_:1})]),default:d(()=>[M(" "+D(u.labelMessage),1)]),_:2},1032,["style"])]),key:"0"}:void 0]),1032,["label","path"])]),_:2},1040))),128)),e.getProps.showActionButtonGroup?(v(),O(p,{key:0,span:e.isInline?"":24,suffix:!!e.isInline},{default:d(({overflow:u})=>[k(y,{align:"center",justify:e.isInline?"end":"start",style:ae({"margin-left":`${e.isInline?12:e.getProps.labelWidth}px`})},{default:d(()=>[e.getProps.showSubmitButton?(v(),O(h,L({key:0},e.getSubmitBtnOptions,{onClick:e.handleSubmit,loading:e.loadingSub,"attr-type":"submit"}),{default:d(()=>[M(D(e.getProps.submitButtonText),1)]),_:1},16,["onClick","loading"])):q("",!0),e.getProps.showResetButton?(v(),O(h,L({key:1},e.getResetBtnOptions,{onClick:e.resetFields}),{default:d(()=>[M(D(e.getProps.resetButtonText),1)]),_:1},16,["onClick"])):q("",!0),e.isInline&&e.getProps.showAdvancedButton?(v(),O(h,{key:2,type:"primary",text:"","icon-placement":"right",onClick:e.unfoldToggle},{icon:d(()=>[u?(v(),O(i,{key:0,size:"14",class:"unfold-icon"},{default:d(()=>[k(w)]),_:1})):(v(),O(i,{key:1,size:"14",class:"unfold-icon"},{default:d(()=>[k(b)]),_:1}))]),default:d(()=>[M(" "+D(u?"展开":"收起"),1)]),_:2},1032,["onClick"])):q("",!0)]),_:2},1032,["justify","style"])]),_:1},8,["span","suffix"])):q("",!0)]),_:3},16)]),_:3},16,["model"])}const Rt=Be(St,[["render",$t],["__scopeId","data-v-c36fe6fa"]]);function At(e){const r=B(null),t=B(!1);async function n(){const a=c(r);return a||console.error("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),await Ae(),a}function o(a){Re(()=>{r.value=null,t.value=null}),!(c(t)&&Fe()&&a===c(r))&&(r.value=a,t.value=!0,ce(()=>e,()=>{e&&a.setProps(Se(e))},{immediate:!0,deep:!0}))}return[o,{setProps:async a=>{await(await n()).setProps(a)},resetFields:async()=>{n().then(async a=>{await a.resetFields()})},clearValidate:async a=>{await(await n()).clearValidate(a)},getFieldsValue:()=>c(r)?.getFieldsValue(),setFieldsValue:async a=>{await(await n()).setFieldsValue(a)},submit:async()=>(await n()).submit(),validate:async a=>(await n()).validate(a),setLoading:a=>{t.value=a},setSchema:async a=>{(await n()).setSchema(a)}}]}export{Rt as B,G as p,At as u};
